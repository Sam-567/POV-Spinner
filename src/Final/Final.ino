#include <Wire.h>
#include "RTClib.h"
#include <Adafruit_DotStar.h>
#include <SPI.h>   

unsigned long totalTime = 0;
double averageSpinTime;
unsigned long currentTime = 0;

int standard = 700;
int tolerance = 50;
RTC_DS1307 RTC;

#define TRUEPIXELS 27
#define NUMPIXELS 14
#define NUMTURNS 120.0
#define HALLSENSOR A0
#define CLOCKPIN 4
#define DISPLAYPIN 5

Adafruit_DotStar strip(TRUEPIXELS,DOTSTAR_BGR);

int Numbers[][5][3] = {
{ { 1, 1, 1},
  { 1, 0, 1},
  { 1, 0, 1},
  { 1, 0, 1},
  { 1, 1, 1}
},

{ { 0, 1, 0},
  { 1, 1, 0},
  { 0, 1, 0},
  { 0, 1, 0},
  { 1, 1, 1}
},

{ { 0, 1, 0},
  { 1, 0, 1},
  { 0, 0, 1},
  { 0, 1, 0},
  { 1, 1, 1}
},
{ { 1, 1, 1},
  { 0, 0, 1},
  { 1, 1, 1},
  { 0, 0, 1},
  { 1, 1, 1}
},
{ { 1, 0, 1},
  { 1, 0, 1},
  { 1, 1, 1},
  { 0, 0, 1},
  { 0, 0, 1}
},

{ { 1, 1, 1},
  { 1, 0, 0},
  { 1, 1, 1},
  { 0, 0, 1},
  { 1, 1, 1}
},

{ { 1, 1, 1},
  { 1, 0, 0},
  { 1, 1, 1},
  { 1, 0, 1},
  { 1, 1, 1}
},

{ { 1, 1, 1},
  { 0, 0, 1},
  { 0, 0, 1},
  { 0, 0, 1},
  { 0, 0, 1}
},

{ { 1, 1, 1},
  { 1, 0, 1},
  { 1, 1, 1},
  { 1, 0, 1},
  { 1, 1, 1}
},
  { { 1, 1, 1},
  { 1, 0, 1},
  { 1, 1, 1},
  { 0, 0, 1},
  { 1, 1, 1}
},

{ { 0, 0, 0},
  { 0, 1, 0},
  { 0, 0, 0},
  { 0, 1, 0},
  { 0, 0, 0}
}};

const PROGMEM byte image[][120][NUMPIXELS] = { 
 {
 { 39, 32, 24, 18, 31, 18, 0, 0, 0, 0, 0, 0, 0, 0 },
 { 38, 34, 25, 18, 17, 22, 28, 29, 17, 26, 58, 17, 0, 0 },
 { 40, 35, 24, 17, 14, 12, 13, 16, 20, 21, 96, 90, 0, 0 },
 { 40, 35, 25, 17, 15, 18, 19, 19, 20, 32, 108, 117, 19, 0 },
 { 40, 35, 25, 17, 17, 22, 23, 24, 25, 60, 133, 117, 76, 0 },
 { 41, 36, 26, 18, 18, 25, 27, 29, 30, 79, 167, 149, 105, 0 },
 { 40, 36, 26, 18, 20, 28, 31, 33, 35, 80, 197, 176, 140, 0 },
 { 40, 36, 27, 19, 22, 32, 35, 36, 36, 65, 218, 196, 153, 0 },
 { 40, 36, 27, 19, 22, 34, 35, 35, 38, 48, 206, 201, 79, 0 },
 { 41, 37, 28, 20, 23, 35, 34, 42, 35, 2, 70, 96, 5, 0 },
 { 41, 38, 28, 21, 24, 33, 40, 26, 0, 0, 0, 0, 0, 0 },
 { 42, 38, 29, 22, 24, 33, 36, 0, 0, 0, 0, 0, 0, 0 },
 { 42, 39, 29, 23, 26, 43, 3, 0, 0, 0, 0, 0, 0, 0 },
 { 41, 39, 29, 25, 30, 23, 0, 0, 0, 0, 0, 0, 0, 0 },
 { 39, 39, 31, 26, 39, 5, 104, 5, 0, 0, 0, 0, 0, 0 },
 { 39, 41, 32, 28, 30, 42, 185, 69, 1, 0, 0, 0, 0, 0 },
 { 42, 40, 32, 30, 27, 86, 207, 178, 48, 0, 0, 0, 0, 0 },
 { 42, 41, 33, 31, 24, 122, 177, 199, 106, 0, 0, 0, 0, 0 },
 { 42, 42, 34, 33, 21, 150, 159, 213, 139, 0, 0, 0, 0, 0 },
 { 42, 42, 35, 35, 34, 175, 209, 230, 161, 0, 0, 0, 0, 0 },
 { 42, 42, 36, 40, 53, 186, 229, 247, 191, 0, 0, 0, 0, 0 },
 { 42, 43, 37, 45, 92, 204, 242, 253, 154, 0, 0, 0, 0, 0 },
 { 42, 43, 38, 50, 120, 219, 249, 253, 72, 0, 0, 0, 0, 0 },
 { 42, 43, 39, 57, 158, 229, 252, 227, 3, 0, 0, 0, 0, 0 },
 { 42, 44, 39, 72, 195, 238, 252, 70, 0, 0, 0, 0, 0, 0 },
 { 43, 39, 36, 95, 217, 246, 175, 0, 0, 0, 0, 0, 0, 0 },
 { 43, 30, 38, 124, 233, 252, 98, 0, 0, 0, 0, 0, 0, 0 },
 { 43, 32, 35, 149, 242, 211, 6, 0, 0, 0, 0, 0, 0, 0 },
 { 43, 30, 55, 179, 247, 157, 0, 0, 0, 0, 0, 0, 0, 0 },
 { 39, 41, 110, 191, 251, 80, 0, 0, 0, 0, 0, 0, 0, 0 },
 { 39, 104, 147, 219, 253, 36, 0, 0, 0, 0, 0, 0, 0, 0 },
 { 43, 90, 187, 232, 237, 4, 0, 0, 0, 0, 0, 0, 0, 0 },
 { 41, 114, 200, 237, 200, 0, 0, 0, 0, 0, 0, 0, 0, 0 },
 { 42, 134, 225, 242, 157, 0, 0, 0, 0, 0, 0, 0, 0, 0 },
 { 41, 136, 228, 246, 131, 0, 0, 0, 0, 0, 0, 0, 0, 0 },
 { 41, 147, 232, 248, 92, 0, 0, 0, 0, 0, 0, 0, 0, 0 },
 { 41, 131, 218, 250, 78, 0, 0, 0, 0, 0, 0, 0, 0, 0 },
 { 41, 135, 205, 252, 57, 0, 0, 0, 0, 0, 0, 0, 0, 0 },
 { 41, 118, 177, 253, 28, 0, 0, 0, 0, 0, 0, 0, 0, 0 },
 { 40, 92, 140, 253, 24, 0, 0, 0, 0, 0, 0, 0, 0, 0 },
 { 41, 53, 87, 252, 9, 0, 0, 0, 0, 0, 0, 0, 0, 0 },
 { 41, 37, 60, 245, 5, 0, 0, 0, 0, 0, 0, 0, 0, 0 },
 { 41, 38, 42, 214, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 },
 { 41, 37, 40, 185, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 },
 { 39, 43, 40, 143, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 },
 { 39, 78, 39, 99, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 },
 { 40, 130, 40, 63, 53, 120, 63, 0, 0, 0, 0, 0, 0, 0 },
 { 41, 166, 45, 118, 240, 244, 241, 32, 0, 0, 0, 0, 0, 0 },
 { 40, 179, 73, 180, 253, 252, 251, 145, 0, 0, 0, 0, 0, 0 },
 { 40, 190, 96, 229, 254, 240, 192, 198, 0, 0, 0, 0, 0, 0 },
 { 40, 191, 152, 246, 204, 125, 163, 207, 122, 0, 0, 0, 0, 0 },
 { 40, 199, 177, 251, 107, 71, 208, 143, 214, 82, 0, 0, 0, 0 },
 { 40, 207, 197, 238, 46, 93, 250, 184, 190, 212, 7, 0, 0, 0 },
 { 39, 204, 207, 211, 55, 160, 252, 225, 177, 239, 104, 0, 0, 0 },
 { 39, 204, 219, 206, 81, 210, 244, 194, 168, 234, 206, 1, 0, 0 },
 { 39, 187, 227, 159, 182, 230, 132, 181, 128, 231, 247, 55, 0, 0 },
 { 39, 194, 231, 112, 232, 232, 52, 149, 120, 229, 244, 136, 0, 0 },
 { 39, 180, 229, 116, 243, 254, 90, 104, 130, 224, 238, 199, 0, 0 },
 { 38, 181, 228, 114, 242, 255, 180, 175, 172, 214, 230, 237, 4, 0 },
 { 39, 189, 223, 141, 241, 255, 255, 214, 170, 229, 224, 244, 13, 0 },
 { 39, 184, 216, 149, 238, 255, 255, 211, 169, 226, 221, 241, 13, 0 },
 { 39, 176, 214, 114, 236, 255, 210, 191, 168, 211, 217, 231, 5, 0 },
 { 39, 174, 207, 109, 231, 255, 88, 97, 132, 204, 221, 193, 0, 0 },
 { 39, 180, 204, 93, 221, 245, 68, 133, 109, 207, 218, 136, 0, 0 },
 { 38, 168, 199, 116, 181, 215, 81, 163, 111, 198, 212, 66, 0, 0 },
 { 37, 179, 193, 164, 93, 210, 187, 161, 145, 189, 188, 3, 0, 0 },
 { 38, 173, 186, 175, 19, 159, 221, 197, 153, 186, 104, 0, 0, 0 },
 { 38, 170, 181, 193, 23, 92, 231, 175, 152, 172, 16, 0, 0, 0 },
 { 38, 157, 167, 209, 64, 37, 188, 90, 169, 86, 0, 0, 0, 0 },
 { 37, 146, 147, 211, 173, 80, 133, 150, 134, 3, 0, 0, 0, 0 },
 { 36, 147, 95, 208, 214, 204, 139, 188, 2, 0, 0, 0, 0, 0 },
 { 37, 130, 58, 179, 218, 222, 191, 145, 0, 0, 0, 0, 0, 0 },
 { 37, 113, 37, 124, 220, 219, 207, 55, 0, 0, 0, 0, 0, 0 },
 { 36, 98, 27, 53, 143, 147, 102, 0, 0, 0, 0, 0, 0, 0 },
 { 39, 68, 23, 60, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 },
 { 39, 41, 20, 91, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 },
 { 34, 28, 21, 124, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 },
 { 35, 27, 21, 148, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 },
 { 35, 30, 26, 175, 4, 0, 0, 0, 0, 0, 0, 0, 0, 0 },
 { 34, 34, 37, 177, 15, 0, 0, 0, 0, 0, 0, 0, 0, 0 },
 { 35, 55, 96, 176, 29, 0, 0, 0, 0, 0, 0, 0, 0, 0 },
 { 35, 91, 146, 175, 31, 0, 0, 0, 0, 0, 0, 0, 0, 0 },
 { 34, 118, 174, 173, 54, 0, 0, 0, 0, 0, 0, 0, 0, 0 },
 { 35, 108, 193, 171, 77, 0, 0, 0, 0, 0, 0, 0, 0, 0 },
 { 34, 124, 207, 169, 80, 0, 0, 0, 0, 0, 0, 0, 0, 0 },
 { 35, 119, 212, 166, 111, 0, 0, 0, 0, 0, 0, 0, 0, 0 },
 { 34, 119, 203, 162, 126, 0, 0, 0, 0, 0, 0, 0, 0, 0 },
 { 35, 100, 183, 159, 165, 0, 0, 0, 0, 0, 0, 0, 0, 0 },
 { 33, 72, 169, 154, 202, 12, 0, 0, 0, 0, 0, 0, 0, 0 },
 { 39, 78, 134, 137, 216, 50, 0, 0, 0, 0, 0, 0, 0, 0 },
 { 39, 23, 96, 119, 213, 96, 0, 0, 0, 0, 0, 0, 0, 0 },
 { 33, 24, 42, 113, 213, 167, 0, 0, 0, 0, 0, 0, 0, 0 },
 { 34, 24, 23, 93, 213, 218, 9, 0, 0, 0, 0, 0, 0, 0 },
 { 35, 25, 22, 79, 215, 242, 116, 0, 0, 0, 0, 0, 0, 0 },
 { 34, 28, 23, 64, 210, 243, 171, 2, 0, 0, 0, 0, 0, 0 },
 { 34, 28, 27, 53, 205, 243, 244, 92, 0, 0, 0, 0, 0, 0 },
 { 35, 29, 27, 45, 187, 244, 247, 227, 13, 0, 0, 0, 0, 0 },
 { 34, 29, 27, 41, 157, 242, 250, 234, 84, 0, 0, 0, 0, 0 },
 { 35, 29, 26, 37, 111, 237, 252, 236, 146, 0, 0, 0, 0, 0 },
 { 34, 29, 27, 32, 57, 232, 249, 236, 169, 0, 0, 0, 0, 0 },
 { 34, 29, 26, 29, 26, 213, 239, 228, 142, 0, 0, 0, 0, 0 },
 { 36, 29, 26, 27, 24, 167, 201, 222, 123, 0, 0, 0, 0, 0 },
 { 35, 29, 26, 25, 26, 140, 221, 218, 96, 0, 0, 0, 0, 0 },
 { 35, 29, 25, 24, 33, 99, 224, 203, 54, 0, 0, 0, 0, 0 },
 { 39, 30, 25, 23, 34, 47, 204, 63, 0, 0, 0, 0, 0, 0 },
 { 39, 30, 24, 21, 34, 7, 94, 4, 0, 0, 0, 0, 0, 0 },
 { 35, 30, 24, 20, 24, 26, 0, 0, 0, 0, 0, 0, 0, 0 },
 { 36, 30, 24, 19, 19, 32, 8, 0, 0, 0, 0, 0, 0, 0 },
 { 36, 30, 24, 18, 17, 22, 33, 1, 0, 0, 0, 0, 0, 0 },
 { 36, 30, 24, 18, 17, 24, 26, 30, 0, 0, 0, 0, 0, 0 },
 { 36, 30, 24, 18, 17, 26, 25, 27, 39, 8, 78, 96, 10, 0 },
 { 37, 30, 24, 17, 16, 28, 27, 25, 26, 39, 190, 170, 71, 0 },
 { 36, 30, 23, 17, 16, 31, 29, 28, 27, 59, 209, 176, 130, 0 },
 { 38, 31, 23, 17, 15, 31, 32, 31, 30, 81, 207, 175, 128, 0 },
 { 37, 30, 23, 16, 15, 31, 33, 32, 33, 89, 193, 168, 109, 0 },
 { 37, 31, 23, 16, 14, 27, 31, 32, 32, 75, 174, 156, 91, 0 },
 { 38, 31, 23, 16, 14, 24, 28, 29, 29, 40, 164, 159, 20, 0 },
 { 38, 32, 23, 17, 15, 17, 26, 31, 37, 36, 144, 118, 0, 0 },
 { 38, 33, 23, 17, 20, 31, 32, 25, 9, 20, 56, 9, 0, 0 },
 { 39, 32, 23, 17, 33, 1, 0, 0, 0, 0, 0, 0, 0, 0 } },
 {
 { 99, 90, 77, 59, 57, 20, 0, 0, 0, 0, 0, 0, 0, 0 },
 { 98, 92, 79, 58, 48, 46, 47, 37, 22, 34, 49, 15, 0, 0 },
 { 99, 92, 76, 58, 48, 47, 50, 51, 52, 56, 65, 65, 0, 0 },
 { 99, 92, 78, 58, 52, 63, 65, 65, 66, 65, 62, 81, 13, 0 },
 { 99, 93, 80, 59, 56, 73, 76, 78, 79, 72, 69, 65, 51, 0 },
 { 99, 94, 81, 60, 61, 80, 83, 85, 86, 76, 84, 76, 67, 0 },
 { 99, 94, 81, 62, 65, 85, 88, 91, 92, 82, 104, 94, 88, 0 },
 { 99, 94, 82, 63, 69, 89, 93, 94, 95, 86, 123, 109, 96, 0 },
 { 99, 95, 84, 65, 71, 92, 94, 95, 97, 91, 119, 107, 49, 0 },
 { 100, 96, 85, 66, 72, 93, 94, 98, 56, 3, 47, 60, 4, 0 },
 { 100, 96, 85, 68, 73, 93, 96, 40, 0, 0, 0, 0, 0, 0 },
 { 100, 97, 87, 70, 74, 91, 57, 0, 0, 0, 0, 0, 0, 0 },
 { 100, 98, 87, 73, 74, 80, 3, 0, 0, 0, 0, 0, 0, 0 },
 { 100, 98, 88, 75, 76, 32, 0, 0, 0, 0, 0, 0, 0, 0 },
 { 99, 99, 90, 77, 75, 5, 109, 5, 0, 0, 0, 0, 0, 0 },
 { 99, 100, 91, 79, 55, 45, 187, 72, 1, 0, 0, 0, 0, 0 },
 { 101, 100, 91, 81, 46, 89, 206, 181, 50, 0, 0, 0, 0, 0 },
 { 101, 101, 92, 83, 39, 123, 179, 199, 107, 0, 0, 0, 0, 0 },
 { 101, 101, 93, 84, 34, 152, 163, 212, 139, 0, 0, 0, 0, 0 },
 { 101, 102, 94, 87, 41, 177, 208, 226, 161, 0, 0, 0, 0, 0 },
 { 101, 102, 96, 90, 53, 186, 225, 241, 188, 0, 0, 0, 0, 0 },
 { 101, 102, 98, 90, 46, 201, 237, 248, 151, 0, 0, 0, 0, 0 },
 { 101, 102, 100, 83, 35, 215, 243, 248, 71, 0, 0, 0, 0, 0 },
 { 101, 102, 100, 69, 14, 224, 246, 223, 3, 0, 0, 0, 0, 0 },
 { 101, 103, 100, 57, 3, 218, 246, 69, 0, 0, 0, 0, 0, 0 },
 { 102, 94, 91, 48, 5, 171, 173, 0, 0, 0, 0, 0, 0, 0 },
 { 101, 78, 95, 37, 9, 80, 96, 0, 0, 0, 0, 0, 0, 0 },
 { 102, 84, 93, 32, 13, 22, 4, 0, 0, 0, 0, 0, 0, 0 },
 { 102, 80, 100, 22, 16, 22, 0, 0, 0, 0, 0, 0, 0, 0 },
 { 99, 82, 132, 20, 17, 14, 0, 0, 0, 0, 0, 0, 0, 0 },
 { 99, 127, 160, 10, 18, 11, 0, 0, 0, 0, 0, 0, 0, 0 },
 { 102, 120, 176, 8, 26, 2, 0, 0, 0, 0, 0, 0, 0, 0 },
 { 101, 134, 165, 10, 24, 0, 0, 0, 0, 0, 0, 0, 0, 0 },
 { 101, 147, 160, 13, 20, 0, 0, 0, 0, 0, 0, 0, 0, 0 },
 { 101, 150, 154, 14, 17, 0, 0, 0, 0, 0, 0, 0, 0, 0 },
 { 101, 155, 143, 15, 13, 0, 0, 0, 0, 0, 0, 0, 0, 0 },
 { 101, 145, 141, 16, 16, 0, 0, 0, 0, 0, 0, 0, 0, 0 },
 { 101, 149, 131, 16, 13, 0, 0, 0, 0, 0, 0, 0, 0, 0 },
 { 100, 139, 127, 16, 8, 0, 0, 0, 0, 0, 0, 0, 0, 0 },
 { 100, 124, 113, 17, 8, 0, 0, 0, 0, 0, 0, 0, 0, 0 },
 { 100, 100, 89, 20, 4, 0, 0, 0, 0, 0, 0, 0, 0, 0 },
 { 101, 92, 93, 23, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 },
 { 101, 92, 101, 24, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 },
 { 101, 90, 100, 29, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 },
 { 99, 89, 99, 35, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 },
 { 99, 73, 96, 41, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 },
 { 100, 54, 88, 45, 46, 91, 50, 0, 0, 0, 0, 0, 0, 0 },
 { 100, 47, 69, 95, 186, 186, 183, 25, 0, 0, 0, 0, 0, 0 },
 { 100, 43, 42, 129, 180, 199, 175, 102, 0, 0, 0, 0, 0, 0 },
 { 99, 37, 30, 160, 181, 186, 108, 143, 0, 0, 0, 0, 0, 0 },
 { 100, 37, 48, 173, 138, 98, 95, 112, 42, 0, 0, 0, 0, 0 },
 { 99, 33, 76, 179, 74, 54, 143, 46, 35, 25, 0, 0, 0, 0 },
 { 98, 26, 104, 171, 35, 70, 197, 124, 22, 38, 3, 0, 0, 0 },
 { 98, 25, 120, 151, 41, 123, 192, 159, 31, 21, 27, 0, 0, 0 },
 { 98, 18, 138, 145, 63, 171, 225, 135, 37, 13, 38, 0, 0, 0 },
 { 97, 21, 151, 110, 135, 200, 172, 143, 16, 11, 25, 18, 0, 0 },
 { 98, 15, 157, 77, 168, 201, 93, 130, 14, 10, 20, 27, 0, 0 },
 { 98, 19, 157, 78, 176, 211, 110, 92, 21, 50, 67, 32, 0, 0 },
 { 96, 22, 155, 78, 176, 212, 170, 118, 54, 91, 157, 40, 1, 0 },
 { 99, 5, 149, 96, 174, 210, 196, 145, 57, 160, 118, 71, 4, 0 },
 { 99, 4, 146, 101, 172, 203, 182, 142, 57, 157, 129, 71, 4, 0 },
 { 96, 20, 147, 78, 169, 197, 155, 129, 54, 96, 129, 36, 2, 0 },
 { 97, 17, 141, 74, 165, 192, 109, 83, 27, 57, 82, 26, 0, 0 },
 { 97, 12, 140, 65, 159, 186, 91, 120, 12, 8, 9, 27, 0, 0 },
 { 96, 17, 135, 81, 132, 173, 152, 134, 13, 8, 18, 21, 0, 0 },
 { 96, 13, 126, 115, 72, 163, 185, 117, 33, 9, 36, 2, 0, 0 },
 { 97, 19, 114, 124, 16, 107, 158, 138, 35, 17, 30, 0, 0, 0 },
 { 96, 18, 103, 139, 19, 65, 162, 121, 21, 35, 7, 0, 0, 0 },
 { 96, 24, 80, 152, 46, 30, 127, 33, 30, 31, 0, 0, 0, 0 },
 { 96, 28, 54, 154, 122, 57, 80, 70, 50, 2, 0, 0, 0, 0 },
 { 95, 27, 27, 151, 151, 141, 83, 129, 2, 0, 0, 0, 0, 0 },
 { 96, 32, 24, 132, 156, 157, 123, 100, 0, 0, 0, 0, 0, 0 },
 { 96, 36, 35, 99, 161, 157, 139, 40, 0, 0, 0, 0, 0, 0 },
 { 95, 44, 44, 51, 116, 108, 75, 0, 0, 0, 0, 0, 0, 0 },
 { 99, 58, 50, 39, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 },
 { 99, 67, 55, 34, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 },
 { 95, 69, 57, 30, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 },
 { 95, 76, 58, 28, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 },
 { 95, 85, 58, 15, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0 },
 { 94, 87, 57, 10, 8, 0, 0, 0, 0, 0, 0, 0, 0, 0 },
 { 95, 103, 93, 5, 11, 0, 0, 0, 0, 0, 0, 0, 0, 0 },
 { 95, 127, 119, 3, 10, 0, 0, 0, 0, 0, 0, 0, 0, 0 },
 { 94, 145, 130, 2, 13, 0, 0, 0, 0, 0, 0, 0, 0, 0 },
 { 94, 139, 141, 2, 14, 0, 0, 0, 0, 0, 0, 0, 0, 0 },
 { 94, 148, 146, 2, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0 },
 { 94, 142, 153, 2, 18, 0, 0, 0, 0, 0, 0, 0, 0, 0 },
 { 94, 142, 155, 1, 15, 0, 0, 0, 0, 0, 0, 0, 0, 0 },
 { 94, 128, 157, 1, 16, 0, 0, 0, 0, 0, 0, 0, 0, 0 },
 { 93, 111, 158, 4, 13, 7, 0, 0, 0, 0, 0, 0, 0, 0 },
 { 99, 112, 134, 11, 4, 13, 0, 0, 0, 0, 0, 0, 0, 0 },
 { 99, 71, 105, 18, 4, 16, 0, 0, 0, 0, 0, 0, 0, 0 },
 { 93, 77, 72, 18, 5, 19, 0, 0, 0, 0, 0, 0, 0, 0 },
 { 94, 76, 67, 28, 6, 17, 5, 0, 0, 0, 0, 0, 0, 0 },
 { 94, 78, 64, 30, 8, 63, 112, 0, 0, 0, 0, 0, 0, 0 },
 { 94, 86, 70, 39, 7, 154, 171, 2, 0, 0, 0, 0, 0, 0 },
 { 94, 87, 81, 46, 5, 210, 238, 92, 0, 0, 0, 0, 0, 0 },
 { 94, 88, 82, 56, 6, 234, 241, 224, 13, 0, 0, 0, 0, 0 },
 { 94, 88, 82, 68, 33, 235, 244, 231, 84, 0, 0, 0, 0, 0 },
 { 95, 88, 82, 72, 54, 231, 246, 232, 148, 0, 0, 0, 0, 0 },
 { 94, 88, 82, 72, 56, 226, 243, 232, 172, 0, 0, 0, 0, 0 },
 { 94, 88, 81, 71, 33, 209, 234, 225, 147, 0, 0, 0, 0, 0 },
 { 95, 88, 80, 70, 36, 163, 200, 219, 127, 0, 0, 0, 0, 0 },
 { 94, 88, 80, 69, 40, 136, 218, 216, 100, 0, 0, 0, 0, 0 },
 { 95, 88, 79, 67, 51, 97, 220, 202, 55, 0, 0, 0, 0, 0 },
 { 99, 88, 79, 67, 57, 46, 202, 66, 0, 0, 0, 0, 0, 0 },
 { 99, 88, 78, 65, 66, 8, 94, 4, 0, 0, 0, 0, 0, 0 },
 { 95, 88, 77, 64, 60, 36, 0, 0, 0, 0, 0, 0, 0, 0 },
 { 95, 88, 78, 63, 59, 64, 10, 0, 0, 0, 0, 0, 0, 0 },
 { 96, 88, 77, 62, 58, 69, 53, 1, 0, 0, 0, 0, 0, 0 },
 { 95, 88, 77, 61, 57, 77, 72, 45, 0, 0, 0, 0, 0, 0 },
 { 96, 88, 77, 60, 56, 82, 78, 73, 60, 10, 54, 65, 8, 0 },
 { 96, 88, 77, 60, 56, 86, 83, 80, 76, 76, 107, 90, 50, 0 },
 { 96, 88, 76, 59, 55, 88, 87, 85, 83, 77, 109, 91, 83, 0 },
 { 97, 88, 76, 58, 53, 88, 90, 89, 87, 82, 118, 93, 79, 0 },
 { 96, 89, 75, 58, 52, 87, 91, 90, 90, 85, 107, 88, 70, 0 },
 { 96, 89, 75, 58, 51, 82, 89, 90, 90, 86, 87, 82, 62, 0 },
 { 97, 88, 75, 57, 49, 75, 86, 86, 87, 84, 84, 100, 14, 0 },
 { 97, 90, 74, 58, 48, 58, 79, 83, 86, 87, 85, 82, 0, 0 },
 { 98, 91, 77, 57, 49, 50, 51, 32, 10, 27, 42, 8, 0, 0 },
 { 99, 90, 76, 58, 58, 2, 0, 0, 0, 0, 0, 0, 0, 0 } },
 {
 { 226, 218, 201, 172, 145, 22, 0, 0, 0, 0, 0, 0, 0, 0 },
 { 225, 220, 203, 170, 147, 131, 107, 75, 39, 62, 53, 15, 0, 0 },
 { 226, 220, 200, 171, 152, 152, 157, 157, 154, 160, 70, 59, 0, 0 },
 { 226, 219, 204, 171, 159, 180, 183, 183, 185, 166, 58, 76, 10, 0 },
 { 226, 221, 205, 173, 166, 196, 200, 202, 203, 150, 55, 53, 36, 0 },
 { 226, 221, 206, 175, 175, 206, 210, 212, 213, 143, 55, 53, 47, 0 },
 { 226, 221, 208, 177, 182, 212, 215, 218, 218, 154, 66, 65, 62, 0 },
 { 226, 222, 209, 180, 188, 217, 220, 221, 222, 175, 83, 78, 73, 0 },
 { 227, 222, 211, 182, 191, 220, 222, 223, 223, 196, 86, 71, 44, 0 },
 { 226, 223, 212, 184, 192, 221, 222, 222, 109, 5, 42, 51, 4, 0 },
 { 227, 224, 213, 187, 195, 221, 219, 75, 0, 0, 0, 0, 0, 0 },
 { 227, 224, 215, 191, 195, 218, 111, 0, 0, 0, 0, 0, 0, 0 },
 { 227, 225, 216, 194, 195, 176, 5, 0, 0, 0, 0, 0, 0, 0 },
 { 227, 225, 216, 197, 194, 59, 0, 0, 0, 0, 0, 0, 0, 0 },
 { 226, 226, 218, 200, 176, 7, 126, 5, 0, 0, 0, 0, 0, 0 },
 { 226, 227, 219, 203, 125, 54, 196, 80, 1, 0, 0, 0, 0, 0 },
 { 227, 227, 219, 204, 100, 100, 211, 192, 56, 0, 0, 0, 0, 0 },
 { 228, 228, 220, 206, 84, 132, 188, 205, 111, 0, 0, 0, 0, 0 },
 { 227, 228, 220, 208, 69, 162, 177, 215, 143, 0, 0, 0, 0, 0 },
 { 228, 228, 223, 210, 67, 190, 213, 227, 164, 0, 0, 0, 0, 0 },
 { 228, 229, 224, 213, 74, 197, 226, 239, 188, 0, 0, 0, 0, 0 },
 { 228, 229, 225, 208, 58, 207, 235, 245, 150, 0, 0, 0, 0, 0 },
 { 228, 229, 228, 187, 40, 218, 241, 245, 71, 0, 0, 0, 0, 0 },
 { 228, 229, 228, 159, 16, 225, 242, 221, 3, 0, 0, 0, 0, 0 },
 { 228, 229, 227, 131, 4, 217, 243, 69, 0, 0, 0, 0, 0, 0 },
 { 228, 217, 215, 111, 7, 171, 171, 0, 0, 0, 0, 0, 0, 0 },
 { 228, 194, 220, 86, 12, 82, 95, 0, 0, 0, 0, 0, 0, 0 },
 { 228, 205, 219, 74, 16, 26, 4, 0, 0, 0, 0, 0, 0, 0 },
 { 228, 198, 193, 47, 19, 26, 0, 0, 0, 0, 0, 0, 0, 0 },
 { 226, 177, 152, 43, 20, 16, 0, 0, 0, 0, 0, 0, 0, 0 },
 { 226, 145, 137, 17, 21, 13, 0, 0, 0, 0, 0, 0, 0, 0 },
 { 228, 163, 106, 10, 31, 2, 0, 0, 0, 0, 0, 0, 0, 0 },
 { 227, 144, 95, 13, 28, 0, 0, 0, 0, 0, 0, 0, 0, 0 },
 { 228, 131, 65, 16, 23, 0, 0, 0, 0, 0, 0, 0, 0, 0 },
 { 228, 136, 66, 17, 20, 0, 0, 0, 0, 0, 0, 0, 0, 0 },
 { 228, 118, 66, 19, 16, 0, 0, 0, 0, 0, 0, 0, 0, 0 },
 { 228, 132, 69, 19, 18, 0, 0, 0, 0, 0, 0, 0, 0, 0 },
 { 228, 122, 79, 19, 15, 0, 0, 0, 0, 0, 0, 0, 0, 0 },
 { 228, 133, 104, 19, 9, 0, 0, 0, 0, 0, 0, 0, 0, 0 },
 { 227, 161, 133, 21, 10, 0, 0, 0, 0, 0, 0, 0, 0, 0 },
 { 228, 199, 185, 24, 4, 0, 0, 0, 0, 0, 0, 0, 0, 0 },
 { 227, 216, 208, 28, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 },
 { 227, 215, 226, 32, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 },
 { 227, 211, 227, 42, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 },
 { 226, 208, 225, 60, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 },
 { 226, 171, 221, 79, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 },
 { 227, 121, 208, 86, 42, 76, 42, 0, 0, 0, 0, 0, 0, 0 },
 { 227, 98, 173, 126, 154, 148, 144, 21, 0, 0, 0, 0, 0, 0 },
 { 227, 89, 115, 130, 142, 159, 134, 81, 0, 0, 0, 0, 0, 0 },
 { 226, 76, 73, 135, 141, 148, 85, 114, 0, 0, 0, 0, 0, 0 },
 { 227, 75, 52, 137, 112, 87, 75, 96, 49, 0, 0, 0, 0, 0 },
 { 226, 66, 67, 140, 68, 58, 109, 36, 44, 30, 0, 0, 0, 0 },
 { 226, 50, 87, 135, 41, 68, 153, 96, 25, 47, 4, 0, 0, 0 },
 { 226, 50, 98, 120, 47, 103, 150, 126, 30, 28, 32, 0, 0, 0 },
 { 225, 33, 111, 115, 63, 145, 216, 111, 34, 17, 46, 0, 0, 0 },
 { 225, 43, 121, 92, 111, 178, 217, 131, 18, 14, 32, 21, 0, 0 },
 { 225, 29, 126, 66, 134, 167, 147, 135, 16, 14, 24, 32, 0, 0 },
 { 225, 39, 126, 67, 139, 166, 152, 104, 21, 53, 70, 38, 0, 0 },
 { 224, 45, 125, 68, 139, 170, 165, 99, 45, 98, 161, 46, 2, 0 },
 { 226, 7, 121, 81, 138, 168, 153, 117, 47, 164, 124, 76, 5, 0 },
 { 226, 6, 120, 85, 136, 160, 138, 114, 47, 162, 135, 76, 5, 0 },
 { 223, 43, 120, 68, 135, 153, 137, 105, 45, 104, 135, 42, 2, 0 },
 { 225, 36, 116, 65, 133, 149, 143, 94, 25, 62, 85, 32, 0, 0 },
 { 224, 25, 116, 58, 129, 149, 146, 131, 15, 10, 12, 33, 0, 0 },
 { 224, 38, 112, 70, 109, 158, 212, 128, 15, 11, 24, 25, 0, 0 },
 { 223, 28, 104, 97, 63, 139, 189, 101, 31, 13, 44, 2, 0, 0 },
 { 224, 42, 95, 103, 20, 86, 129, 113, 33, 23, 36, 0, 0, 0 },
 { 223, 41, 86, 115, 24, 60, 128, 100, 24, 44, 8, 0, 0, 0 },
 { 223, 56, 68, 124, 47, 35, 101, 26, 38, 37, 0, 0, 0, 0 },
 { 224, 64, 48, 126, 101, 56, 66, 66, 58, 2, 0, 0, 0, 0 },
 { 223, 64, 48, 125, 124, 119, 71, 107, 2, 0, 0, 0, 0, 0 },
 { 224, 76, 77, 123, 127, 131, 100, 82, 0, 0, 0, 0, 0, 0 },
 { 223, 87, 110, 126, 133, 131, 113, 34, 0, 0, 0, 0, 0, 0 },
 { 222, 105, 133, 93, 103, 92, 64, 0, 0, 0, 0, 0, 0, 0 },
 { 226, 142, 147, 77, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 },
 { 226, 172, 161, 63, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 },
 { 222, 182, 163, 50, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 },
 { 222, 194, 166, 42, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 },
 { 223, 210, 164, 20, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0 },
 { 222, 208, 158, 12, 9, 0, 0, 0, 0, 0, 0, 0, 0, 0 },
 { 222, 192, 117, 7, 13, 0, 0, 0, 0, 0, 0, 0, 0, 0 },
 { 222, 156, 86, 4, 11, 0, 0, 0, 0, 0, 0, 0, 0, 0 },
 { 222, 135, 74, 3, 15, 0, 0, 0, 0, 0, 0, 0, 0, 0 },
 { 222, 160, 65, 3, 16, 0, 0, 0, 0, 0, 0, 0, 0, 0 },
 { 222, 153, 55, 3, 14, 0, 0, 0, 0, 0, 0, 0, 0, 0 },
 { 222, 142, 54, 3, 21, 0, 0, 0, 0, 0, 0, 0, 0, 0 },
 { 222, 142, 64, 3, 18, 0, 0, 0, 0, 0, 0, 0, 0, 0 },
 { 222, 156, 85, 3, 20, 0, 0, 0, 0, 0, 0, 0, 0, 0 },
 { 221, 176, 88, 8, 17, 9, 0, 0, 0, 0, 0, 0, 0, 0 },
 { 226, 165, 102, 25, 6, 15, 0, 0, 0, 0, 0, 0, 0, 0 },
 { 226, 189, 115, 47, 6, 19, 0, 0, 0, 0, 0, 0, 0, 0 },
 { 221, 201, 155, 47, 7, 23, 0, 0, 0, 0, 0, 0, 0, 0 },
 { 222, 198, 185, 73, 8, 21, 5, 0, 0, 0, 0, 0, 0, 0 },
 { 222, 201, 178, 82, 10, 64, 113, 0, 0, 0, 0, 0, 0, 0 },
 { 222, 213, 188, 104, 8, 154, 174, 2, 0, 0, 0, 0, 0, 0 },
 { 222, 215, 207, 122, 6, 208, 236, 92, 0, 0, 0, 0, 0, 0 },
 { 222, 216, 209, 148, 7, 232, 238, 224, 13, 0, 0, 0, 0, 0 },
 { 222, 216, 209, 173, 35, 233, 241, 231, 86, 0, 0, 0, 0, 0 },
 { 223, 217, 207, 185, 64, 229, 243, 232, 152, 0, 0, 0, 0, 0 },
 { 223, 217, 209, 186, 77, 226, 240, 232, 179, 0, 0, 0, 0, 0 },
 { 222, 216, 207, 186, 62, 211, 232, 226, 156, 0, 0, 0, 0, 0 },
 { 223, 217, 205, 186, 76, 163, 204, 221, 136, 0, 0, 0, 0, 0 },
 { 222, 216, 205, 185, 89, 136, 219, 218, 107, 0, 0, 0, 0, 0 },
 { 222, 216, 204, 183, 109, 97, 221, 208, 59, 0, 0, 0, 0, 0 },
 { 226, 216, 205, 182, 133, 46, 207, 71, 0, 0, 0, 0, 0, 0 },
 { 226, 216, 204, 181, 167, 12, 101, 4, 0, 0, 0, 0, 0, 0 },
 { 223, 216, 202, 180, 169, 70, 0, 0, 0, 0, 0, 0, 0, 0 },
 { 223, 216, 203, 179, 170, 159, 16, 0, 0, 0, 0, 0, 0, 0 },
 { 223, 216, 202, 177, 169, 187, 118, 1, 0, 0, 0, 0, 0, 0 },
 { 223, 215, 201, 176, 169, 201, 188, 95, 0, 0, 0, 0, 0, 0 },
 { 223, 215, 201, 174, 168, 209, 203, 190, 124, 18, 50, 59, 9, 0 },
 { 224, 215, 201, 173, 167, 213, 210, 205, 197, 181, 77, 62, 49, 0 },
 { 223, 215, 200, 172, 166, 215, 215, 212, 209, 162, 64, 58, 69, 0 },
 { 224, 216, 200, 172, 163, 215, 217, 216, 214, 153, 85, 64, 57, 0 },
 { 224, 216, 199, 171, 161, 214, 218, 218, 217, 151, 78, 61, 48, 0 },
 { 224, 217, 199, 170, 157, 207, 217, 217, 217, 166, 58, 58, 42, 0 },
 { 225, 215, 199, 170, 154, 196, 213, 214, 214, 197, 61, 83, 10, 0 },
 { 225, 217, 196, 170, 150, 169, 203, 205, 203, 208, 78, 66, 0, 0 },
 { 224, 218, 201, 169, 145, 114, 101, 56, 15, 49, 42, 7, 0, 0 },
 { 226, 217, 200, 171, 142, 2, 0, 0, 0, 0, 0, 0, 0, 0 } } };


void setup() {
  Wire.begin();
  RTC.begin();
  strip.begin();
  
  int i = 0;
  while (i < 28) {
    strip.setPixelColor(i, strip.Color(0,0,0));
    i++;
  }
  strip.show();
  delay(500);
  pinMode(HALLSENSOR, INPUT);
  pinMode(CLOCKPIN, INPUT);
  pinMode(DISPLAYPIN, INPUT);
  calculateAverageSpin();
}

void loop(){
  strip.clear();
  if( digitalRead(CLOCKPIN) == HIGH){
    digitalClock();
  } else if ( digitalRead(DISPLAYPIN) == HIGH){
    displayImage();
  }
}

void calculateAverageSpin(){
  int i = 0;
  unsigned long lastTime = micros();
  unsigned long currentTime;
  int x = 0;
  strip.setPixelColor(2,100,0,0);
  while( i < 40 ){
    while ( abs( analogRead(HALLSENSOR) - standard ) <= tolerance ) {
      delayMicroseconds(100);
    }
    if( micros() - lastTime < 250000 ){
      if( x > 15 ){
        currentTime = micros();
        totalTime += currentTime - lastTime;
        lastTime = currentTime;
        delay(25);
        i++;
      } else {
        x++;
      }
      strip.show();
    } else if {
      lastTime = micros();
    }
  }
  
  double average = totalTime / 40.0;

  averageSpinTime = average;
}

void digitalClock() {
  int spins = 0;
  while (spins < 20){
    DateTime now = RTC.now();
  
    int minute = now.minute();
    int hour = now.hour();
    if (hour > 12) { hour -= 12;}
    int LowMin = minute % 10;
    int HighMin = minute / 10;
    int LowHour = hour % 10;
    int HighHour = hour / 10;
  
  
    while ( abs( analogRead(HALLSENSOR) - standard ) <= tolerance ) {
      delay(0.5);
    }
    for (int i = 2; i >= 0; i--) {
      for ( int pin = 0; pin < 5; pin++ ) {
        strip.setPixelColor(pin, Numbers[LowMin][pin][i] * strip.Color(0,150,0));
      }
      strip.show();
      delay(2);
    }
  
    for ( int pin = 0; pin < 12; pin++ ) {
        strip.setPixelColor(pin, 0);
    }
    strip.show();
    delay(2);
  
    for (int i = 2; i >= 0; i--) {
      for ( int pin = 0; pin < 5; pin++ ) {
        strip.setPixelColor(pin,  strip.Color(0, Numbers[HighMin][pin][i] * 150,0));
      }
      strip.show();
      delay(2);
    }
  
    for (int i = 2; i >= 0; i--) {
      for ( int pin = 0; pin < 5; pin++ ) {
        strip.setPixelColor(pin, strip.Color(0, Numbers[10][pin][i] * 150,0));
      }
      strip.show();
      delay(2);
    }
  
    for (int i = 2; i >= 0; i--) {
      for ( int pin = 0; pin < 5; pin++ ) {
        strip.setPixelColor(pin, strip.Color(0, Numbers[LowHour][pin][i] * 150,0));
      }
      strip.show();
      delay(2);
    }
  
    if( HighHour != 0 ){
      for ( int pin = 0; pin < 12; pin++ ) {
        strip.setPixelColor(pin, 0 );
      }
      strip.show();
      delay (2);
  
      for (int i = 2; i >= 0; i--) {
        for ( int pin = 0; pin < 5; pin++ ) {
          strip.setPixelColor(pin, strip.Color(0, Numbers[HighHour][pin][i] * 150,0)); 
        }
        strip.show();
        delay(2);
      }
    }
    
    for ( int pin = 0; pin < 12; pin++ ) {
        strip.setPixelColor(pin, 0 );
    }
    strip.show();
    spins++;
  }
}

void displayImage() {

  int spins = 0;
  while (spins < 20) {
    while ( abs( analogRead(HALLSENSOR) - standard ) <= tolerance ) {
      delayMicroseconds(100);
    }
    
    currentTime = micros();
  
    for (int arg = 0; arg < NUMTURNS; arg++) {
      for (int mod = 0; mod < NUMPIXELS; mod++) {
        strip.setPixelColor( 13 - mod, pgm_read_byte(&(image[0][arg][mod])), pgm_read_byte(&(image[1][arg][mod])), pgm_read_byte(&(image[2][arg][mod])) );
      }
      while ( micros() - currentTime <  ((double) arg)*(averageSpinTime/(NUMTURNS))){
        delayMicroseconds(100);
      }
      strip.show();
    }
  spins++;
  }
}
